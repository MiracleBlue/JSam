<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8" />
    <title>JSam - a modular audio toolkit for javascript</title>
    <link href="./css/bootstrap.css" rel="stylesheet" />
    <link href="./css/style.css" rel="stylesheet" />

    <script src="./src/lib/require.js"></script>
    <script>

      require([
        'src/lib/zepto',
        'src/midi/keyboard',
        'src/midi/arpeggiator',
        'src/core/instrument',
        'src/core/oscilloscope',
        'src/core/speaker'
      ], function($, MidiKeyboard, Arpeggiator, Instrument, Oscilloscope, Speaker) {

        var keyboard = new MidiKeyboard(),
          arpeggiator = new Arpeggiator(),
          instrument = new Instrument(),
          oscilloscope = new Oscilloscope(),
          speaker = new Speaker();

        // controller instrument with midi keyboard
        keyboard.midiOut(arpeggiator);
        arpeggiator.midiOut(instrument);

        // create graph
        // instrument => oscilloscope => speaker
        instrument.outputs.at(0).connect(oscilloscope.inputs.at(0));
        oscilloscope.outputs.at(0).connect(speaker.inputs.at(0));

        $('body').append(oscilloscope.view.render().el);

      });

    </script>
    
  </head>

  <body>
    <p>click in this frame to capture keyboard events and type with your keys to make noises</p>
  </body>

</html>